<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lancer VHR Dashboard - VHR DASHBOARD</title>
    <link rel="stylesheet" href="/launch-dashboard.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ VHR Dashboard</h1>
            <p class="subtitle">Lancer en local sur votre ordinateur</p>
        </header>
        
        <div class="info-box">
            <strong>‚ÑπÔ∏è Informations :</strong>
            <p>Cliquez ci-dessous pour t√©l√©charger et lancer le dashboard. Le serveur d√©marre automatiquement en arri√®re-plan.</p>
        </div>
        
        <button class="launch-btn" id="launchBtn">
            üöÄ Lancer le Dashboard
        </button>
        
        <div class="success-message" id="successMsg">
            ‚úì Script t√©l√©charg√© ! Double-cliquez sur le fichier pour lancer.
        </div>
        
        <div class="authentication-notice">
            <h3>üîê Authentification requise</h3>
            <p>Une fois le dashboard ouvert, <strong>vous devez vous authentifier</strong> pour que la p√©riode d'essai de <strong>7 jours</strong> commence.</p>
            <p>Vous pouvez :</p>
            <ul>
                <li><strong>Cr√©er un compte</strong> avec votre email</li>
                <li><strong>Vous connecter</strong> si vous avez d√©j√† un compte</li>
            </ul>
            <p style="margin-top: 15px; font-size: 0.9em; color: #f39c12;">üí° <strong>Conseil :</strong> Gardez votre session ouverte pour que le d√©compte des 7 jours soit actif.</p>
        </div>
        
        <div class="steps">
            <h3>üìã Comment √ßa marche :</h3>
            
            <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <strong>Cliquer sur le bouton</strong>
                    <p>Appuyez sur "Lancer le Dashboard" ci-dessus</p>
                </div>
            </div>
            
            <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <strong>Nouvelle fen√™tre</strong>
                    <p>Le dashboard s'ouvre dans une nouvelle fen√™tre du navigateur</p>
                </div>
            </div>
            
            <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <strong>Utiliser le dashboard</strong>
                    <p>Vous pouvez maintenant acc√©der √† toutes les fonctionnalit√©s</p>
                </div>
            </div>
        </div>
        
        <div class="requirements">
            <h3>‚ú® Pr√©requis :</h3>
            <ul>
                <li>Serveur local en cours d'ex√©cution (port 3000)</li>
                <li>Navigateur web moderne (Chrome, Edge, Firefox)</li>
                <li>Cookies activ√©s</li>
            </ul>
        </div>
        
        <footer>
            <p>Pour les probl√®mes : <a href="/contact.html">Contactez-nous</a> | <a href="/">Retour au site</a></p>
        </footer>
    </div>
    
    <script src="/js/launch-dashboard.js"></script>
</body>
</html>
            color: #ecf0f1;
        }
        
        .requirements li:before {
            content: "‚úì ";
            color: #2ecc71;
            font-weight: bold;
            margin-right: 8px;
        }
        
        .success-message {
            display: none;
            background: #27ae60;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        
        .success-message.show {
            display: block;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #2c3e50;
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        a {
            color: #3498db;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü•Ω VHR Dashboard</h1>
            <p class="subtitle">Lancez le dashboard en local</p>
        </header>
        
        <div class="info-box">
            <strong>‚ÑπÔ∏è Informations :</strong>
            <p>Le dashboard VHR fonctionne mieux en local sur votre ordinateur. Cliquez ci-dessous pour t√©l√©charger et lancer automatiquement.</p>
        </div>
        
        <button class="launch-btn" id="launchBtn" onclick="launchDashboard()">
            üöÄ Lancer le Dashboard
        </button>
        
        <div class="success-message" id="successMsg">
            ‚úì Dashboard lanc√© avec succ√®s !
        </div>
        
        <div class="steps">
            <h3 style="color: #3498db; margin-bottom: 20px;">üìã √âtapes du processus :</h3>
            
            <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <strong>T√©l√©chargement</strong>
                    <p>Le fichier ZIP est t√©l√©charg√© depuis les serveurs VHR</p>
                </div>
            </div>
            
            <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <strong>Extraction</strong>
                    <p>Le fichier est extrait dans un dossier temporaire</p>
                </div>
            </div>
            
            <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <strong>Lancement</strong>
                    <p>Le dashboard d√©marre automatiquement dans votre navigateur</p>
                </div>
            </div>
        </div>
        
        <div class="requirements">
            <h3>‚ú® Pr√©requis :</h3>
            <ul>
                <li>Windows 7 ou sup√©rieur</li>
                <li>PowerShell 5.0+</li>
                <li>Navigateur web moderne (Chrome, Edge, Firefox)</li>
                <li>Environ 500 MB d'espace disque</li>
            </ul>
        </div>
        
        <footer>
            <p>Pour les probl√®mes : <a href="/contact.html">Contactez-nous</a> | <a href="/">Retour au site</a></p>
        </footer>
    </div>
    
    <script>
        async function launchDashboard() {
            const btn = document.getElementById('launchBtn');
            const successMsg = document.getElementById('successMsg');
            
            // D√©sactiver le bouton
            btn.disabled = true;
            btn.classList.add('loading');
            btn.textContent = '‚è≥ Lancement en cours...';
            successMsg.classList.remove('show');
            
            try {
                // Appeler l'endpoint du serveur pour t√©l√©charger le script
                const response = await fetch('/download/launch-script');
                
                if (!response.ok) {
                    throw new Error('Erreur lors du t√©l√©chargement du script');
                }
                
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'launch-dashboard.ps1';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                
                // Afficher le message de succ√®s
                successMsg.classList.add('show');
                btn.textContent = '‚úì Script t√©l√©charg√© !';
                
                // R√©initialiser apr√®s 3 secondes
                setTimeout(() => {
                    btn.disabled = false;
                    btn.classList.remove('loading');
                    btn.textContent = 'üöÄ Lancer le Dashboard';
                }, 3000);
                
            } catch (error) {
                console.error('Erreur:', error);
                btn.textContent = '‚úó Erreur - R√©essayez';
                btn.disabled = false;
                btn.classList.remove('loading');
                
                setTimeout(() => {
                    btn.textContent = 'üöÄ Lancer le Dashboard';
                }, 3000);
            }
        }
    </script>
</body>
</html>
